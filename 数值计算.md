# 数值计算

## 解方程

问题：对5次及以上根及超越方程无解析解

解决：根存在性->根的分布->根的精确化（狭义数值方法）

### 二分法

利用零点存在定理，二分选择时保证边界异号；
$$
|x^*-x_k|<\epsilon\Rightarrow k>\frac{\ln(a-b)-\ln2\epsilon}{\ln2},[a,b]为初始待求域
$$

### 迭代法（不动点法）

$$
f(x)=0\Rightarrow f(x)=g(x,h(x))\Rightarrow x=\phi(x),其中\phi不唯一\\
求x^*即求y=\phi(x)函数系不动点（同时也是y=\phi(x)与y=x交点）\\
即希望求得\phi_1(x)-\phi_2(x)=0的解,如果两个函数都对不动点收敛，即可利用\phi_1(\phi_2(x_i))逼近x^*\\
$$

由于$\phi(x)$选取自由度很大，因此只要选择的函数收敛性足够好，求解效率能得到极大提升。一般来说，固定其中一个函数为$y=x$，这样就可以只考虑一个函数相对之的收敛性：
$$
迭代收敛基本定理：迭代函数\phi(x)有唯一的不动点x^*，且对任意初值x_0\in[a,b]有近似序列:\\
\lim_{k\rightarrow\infty}\{x_k=\phi(x_{k-1})\}=x^*\in[a,b]\\
充分条件为：
①\phi(x)在[a,b]连续，在(a,b)可导\\
②x\in[a,b]\Rightarrow \phi(x)\in[a,b]\\
③x\in[a,b]\Rightarrow |\phi'(x)|<1,其有上界L\\
三个条件分别称为连续性、映内性和压缩性，且有误差估计公式:\\
|x_k-x^*|\leq\frac{1}{1-L}|x_{k-1}-x_k|\leq\frac{L}{1-L}|x_k-x_{k-1}|\leq\frac{L^k}{1-L}|x_1-x_0|\\
$$
本质就是$\phi(x)-x$有界且单调。而误差估计直接来自于中值定理（相邻代互为x-y，递推得）。收敛的速度可以由L估计。然而，以上公式只是收敛速度的线性模拟，要想精确得到更快收敛函数的手来你速度，还需要确定收敛的阶次，即相邻代无穷小阶次：
$$
c=\lim_{k\rightarrow\infty}\frac{|x_{k+1}-x_k|}{|x_k-x_{k-1}|^p}\\
即，下一代（k+1）是相对上一代（k）的p阶无穷小，p称为收敛阶\\
p=1为线性收敛，p>1称超线性收敛\\
$$
那么是否能从迭代函数直接求得收敛阶？我们仍需要回归本质：$\phi(x)-x$的收敛速度，由于用阶来描述，就相当于其在零点的泰勒展开多项式最低次：$x-x^*$就是无穷小量，那么泰勒展开的主部就是$\phi(x)-x$无穷小的阶数；而后者能够轻易地求取：$\phi^{(p)}(x)!=0$的最小p值。注意，由于压缩性，函数至少已经满足线性收敛，因此p从2开始计算，由此就相当于获得了**整数阶超线性收敛定理**。

然而，我们没法确保函数的收敛阶超线性，因此需要一个构造方法：
$$
Steffensen迭代法：对有不动点的\phi(x)，只需满足\phi’(x^*)\neq1,可构造:\\
\Phi(x)=x-\frac{[\phi(x)-x]^2}{\phi(\phi(x))-2\phi(x)+x},至少平方收敛。\\
本质：对每一个迭代近似值x(k+1)，都可以用\frac{x_{k+1}-x^*}{x_k-x^*}=\frac{x_{k+2}-x^*}{x_{k+1}-x^*}求解一个更好的x^*\\
即构造一个线性收敛的情况,强制\Phi'(x^*)=0,用\phi反解\Phi。
$$
然而既然使用了泰勒展开式，理所应当的可以解出：
$$
牛顿迭代法：x_{k+1}=\phi(x)=x_k-\frac{f(x_k)}{f'(x_k)}\\
泰勒展开：f(x^*)=f(x_k)+f'(x_k)(x^*-x_k)+o((x^*-x_k)^2)=0
$$
至少为平方收敛，但是牛顿法求导困难，因此有多种方法近似：
$$
截弦迭代法：x_{k+1}=\phi(x)=x_k-\frac{f(x_k)}{f(x_k)-f(x_{k-1})}(x_k-x_{k-1})\\
$$

收敛阶为$\frac{1+\sqrt{5}}{2}$.

# 解方程组

### 高斯（-约当）消元法

解方程的目的，是使三个变量解耦，因此解方程就是标准化。对于线性方程组而言，可以接受的两种形式分别对应了上三角阵和单位阵，又分别对应高斯消元法和约当消元法，后者是前者更严的标准化。

消元，对一个式子选定一个变量，带入其他式子，从而使其他式都不含该变量。在矩阵中，列一一对应变量，因此消元就对应利用一行去把其中其他行的某列全部消为0。若使用**顺序消元**：
$$
a^{k}_{kj}=\frac{a^{k-1}_{kj}}{a^{k-1}_{kk}},(当前行k对角元素总为主元素)\\
a^{k}_{ij}=a^{k-1}_{ij}-a^{k-1}_{ik}\cdot a^{k}_{kj},(i>k,对下方行消元)
$$
由于被消式的变量应该大于等于消元式，因此消元呈现每行依次对后行消元，即上三角化。对有唯一解方程，上三角化的末行一定是某变量解，依此回代即可得到所有变量。

但这只是理论上，在实际工程中，除法会出现巨大的问题：对角主元素可能计算前后等于零，计算无法继续进行；主元素如果式很小的数，其误差即使很小也会因为除法带来巨大的误差，因此需要尽量使大数放分母，即尽量使对角主元素系数较大。因此每一次消元计算前都可以预处理，依此为每列选取一个主元素：

- 全主元素高斯消去法：从对角元素的右下方矩阵选取主元素；
- 列主元素高斯消去法：从对角元素同列下方选取主元素；
  - 全主元素设计换元，比较复杂；而列主元素已经可以保证$|\frac{a^{k-1}_{kj}}{a^{k-1}_{kk}}|<1$，因此列主元素应用更广。

然而，回代的本质其实就是对角化，因此提出直接对角化的算法高斯-约当消元法：因此当前行总是秩最少行，因此除了下方外上方也可以消元，即每次消元都对所有其他行消元即可（即上式$i>k$改为$i\neq k$）。

消元指将$Ax=b$转化为$Ux=y$，U为上三角矩阵->

消元过程就是对$A=LU$求U和L，方法为解$Ly=b$再回代，但后者也需要消元，故递归求解->

即利用初等变换实现LU分解->

解线性方程组的本质：LU分解；解的唯一性->LU分解的唯一性。

进一步，高斯约当消元法需要求得希望U直接算得为单位阵，这使得L不再保证为下三角，反而成为A的逆矩阵。

### LU分解（直接三角分解）

当解唯一时，LU都可逆，得到$L^{-1}A=U$，由于U是上三角，A无规定，则$L^{-1}$必然为下三角矩阵，考虑$LL^{-1}=I$，因此$L$必然也是下三角阵，是为三角阵分解：
$$
1.由于a_{ij}由上下三角阵相乘，因此a_{ij}总是只和L、U左上的元素有关，即：\\
2.a_{ij}=f(l_{i'j'},u_{i'j'}),其中i'\leq i,j'\leq j(只与顺序主子式内有关)\\
3.如果已知某l_{kr},则最开始可以先求得对应方程的u，然后再反过来求L\\
4.每一次迭代都可以求得一列一行，使得下一个迭代的左上元素恒为已知\\
计算顺序：u_1,l_1,u_2,l_2,...,u_n\begin{cases}
A的K行a_{kj}=\sum^{k-1}_{r=1}l_{kr}u_{rj}+l_{jj}u_{kj},(l_{jj}=1,)解得u_k\\
A的K列a_{ik}=\sum^{k-1}_{r=1}l_{ir}u_{rk}+l_{ik}u_{kk},解得l_k
\end{cases}
$$
已知LU分解与解一一对应，那就势必可以找到**直接**由原矩阵求得LU的算法。

- 显然，要解得行或列方程，需要指定每一个$l_{jj}$或$u_{ii}$。由于希望$U$无规定，令$l_{jj}=1$（LU中L对角元素全为1），尤其是对$(1,1)$意味着整个原矩阵$A$第一行就等于$U$的第一行，而L第一列就等于$a_{i1}/u_{11}$.
  - 根据上面方程可知，只要每一对U的k行和L的k列内至少有一个非零指定值的元素，即可保证唯一分解。最方便的就是某一矩阵对角被指定，LU分解就是一个特例——事实上，当指定上三角矩阵U对角元素全为1时，称为**Crout分解**，而的相对应的之前所说的LU分解称为**Doolittle分解**。
- 由于上下三角的特性，$a_{ij}$只和$i$行$U$和$j$列$L$有关，而$i$行$U$只和$j-1$列$L$和$i-1$行$U$有关（顺序主子式内），由此可以得到每一行U都可以通过已知的$a_{ij}$，$l_{ij}$，$u_{ij}$表示，而每一列$l_{ij}$都可以通过$a_{ij}$对应方程由算得的$u_{ij}$解出。由于与解一一对应，可以得到LU分解需要保证$A$各界顺序主子式不为零，对应方程有唯一解，方能计算，否则对某阶主子式内必然出现无数解而无法继续迭代。

可以看到，和高斯消元法一样，LU也是靠迭代消元实现的，事实上他们的计算量都是$o(\frac{n^3}{3})$，但LU直接分解相比高斯消元有以下优势：

- 存储单元少，因为每一代$a,b$在参与计算后下一次迭代中无需保留，因此大大节省存储空间；
- 三角分解和右端项无关，即$b$再分解前后即无需改变，也不用参与计算，系数矩阵不变时无需重复计算；
- 分解后可以轻易求得原矩阵行列式$\det A=\det L × \det U = \sum_{i=1}^n u_{ii}=\trace U$

同时，主元素选取策略也可以应用在直接三角分解上。

在求解线性方程组时，有一种特殊的方程形态大量出现，尤其线性微分方程组，那就是三对角线系数矩阵。幸运的是，三对线矩阵的三角分解非常容易推导：显而易见分解的两个三角阵都是双对角线。此时应用直接三角分解将会变得非常便利：每代方程组两个方程都直接分别解出一个值即可，因此求解顺序快速地按照$l_1,u_1，l_2，u_2...$的顺序进行，被形象描述为**追赶法**，即直接三角分解每代方程组的两个方程中有指定值1的为“追”，回代的方程为“赶“。

### 线性方程组的误差分析

主元素消元法中我们已经展现了数值分析的两种希望：算法足够高效，同时误差足够小。因此我们往往需要先确定方程是否是一种容易使既定算法产生巨大误差的形式（例如对顺序高斯消元而言，对角元素绝对值小就是大问题）。

对于一个线性方程组，我们有病态这一概念描述其误差敏感度：
$$
Ax=b，若A、b的扰动产生解x的更大扰动，称该方程为病态方程组:\\
用相对误差\frac{||\delta x||}{||x||}描述扰动，有结论：\\
b\neq0,只有b有扰动:\frac{||\delta x||}{||x||}\leq||A||\cdot||A^{-1}||\leq\frac{||\delta b||}{||b||}\\
A\neq0,只有A有扰动:\frac{||\delta x||}{||x+\delta x6||}\leq||A||\cdot||A^{-1}||\cdot\frac{||\delta A||}{||A||}\\
当扰动||\delta A||很小时，可以近似认为x扰动不超过A、b扰动的||A||\cdot||A^{-1}||倍，称为条件数cond(A)
$$
注意，我们使用的范数$||\cdot||$并没有限定，因为矩阵的范数一般有行范数、列范数和欧几里得范数三种，因此条件数也相应分为$cond_{\infty}(A),cond_{1}(A),cond_{2}(A)$三种。然而，实际运用中矩阵的范数计算复杂，一般是直接通过求解判断病态特征，而条件数时作为定量分析方法存在。

### 雅各比迭代法





